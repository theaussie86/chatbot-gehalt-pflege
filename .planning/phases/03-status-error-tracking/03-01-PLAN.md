---
phase: 03-status-error-tracking
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/api/components/DocumentManager.tsx
  - apps/api/components/ui/sheet.tsx
autonomous: true

must_haves:
  truths:
    - "Document rows display status with icon and text badge"
    - "Processing documents show pulsing animation on badge"
    - "Filter chips appear above document list showing counts"
    - "Clicking a chip filters the list to that status"
    - "Multiple chips can be selected to combine filters"
  artifacts:
    - path: "apps/api/components/DocumentManager.tsx"
      provides: "Enhanced status badges with icons and filter chips"
      contains: "StatusBadge|FilterChips"
    - path: "apps/api/components/ui/sheet.tsx"
      provides: "Sheet component for future side panel"
      contains: "Sheet"
  key_links:
    - from: "FilterChips state"
      to: "filtered documents list"
      via: "useMemo filtering"
      pattern: "filteredDocuments.*filter"
---

<objective>
Enhance document status display with icon badges and add status filter chips.

Purpose: Provide clear visual feedback about document processing state and enable admins to quickly find documents by status.

Output: DocumentManager with enhanced status badges (icon + text, muted colors, pulsing animation) and filter chips with counts.
</objective>

<execution_context>
@/Users/cweissteiner/.claude/get-shit-done/workflows/execute-plan.md
@/Users/cweissteiner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-status-error-tracking/03-CONTEXT.md
@apps/api/components/DocumentManager.tsx
@apps/api/components/ui/badge.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Sheet component from shadcn/ui</name>
  <files>apps/api/components/ui/sheet.tsx</files>
  <action>
    Add shadcn/ui Sheet component for later use in side panel (Plan 02 dependency).

    Run: `npx shadcn@latest add sheet` in the apps/api directory.

    This installs the Sheet component which will be used for the document details side panel in the next plan. Installing it now ensures Plan 02 has no setup work.
  </action>
  <verify>File apps/api/components/ui/sheet.tsx exists and exports Sheet, SheetContent, SheetHeader, SheetTitle, SheetDescription</verify>
  <done>Sheet component available in apps/api/components/ui/sheet.tsx</done>
</task>

<task type="auto">
  <name>Task 2: Enhance status badges with icons and muted colors</name>
  <files>apps/api/components/DocumentManager.tsx</files>
  <action>
    Replace the existing `getStatusColor` function and Badge usage with an enhanced StatusBadge component.

    Create inline StatusBadge component within DocumentManager.tsx:

    1. Define StatusBadge component that renders icon + text:
       - pending: Clock icon + "Pending" (slate-400 background, slate-600 text)
       - processing: Spinner icon + "Processing" (sky-400 background, sky-700 text, animate-pulse)
       - embedded: CheckCircle icon + "Embedded" (emerald-400 background, emerald-700 text)
       - error: XCircle icon + "Error" (rose-400 background, rose-700 text)

    2. Icon specifications (inline SVGs, 14x14 size):
       - Clock: simple clock face outline
       - Spinner: circular loading indicator
       - CheckCircle: circle with checkmark
       - XCircle: circle with X

    3. Badge styling:
       - Muted background colors (bg-slate-100, bg-sky-100, bg-emerald-100, bg-rose-100)
       - Text colors slightly darker (text-slate-600, text-sky-700, text-emerald-700, text-rose-700)
       - Processing badge has `animate-pulse` class for pulsing animation
       - Rounded-full, px-2.5 py-0.5, text-xs font-medium
       - Right-aligned within the document row

    4. Replace the Badge import usage with StatusBadge component call

    5. Remove the old `getStatusColor` function entirely
  </action>
  <verify>
    Run dev server (`npm run dev:api`) and verify:
    - Status badges show icon + text
    - Colors match spec (muted palette)
    - Processing status has visible pulse animation
  </verify>
  <done>All four status states render with correct icon, text, and color; processing pulses</done>
</task>

<task type="auto">
  <name>Task 3: Add filter chips with status counts</name>
  <files>apps/api/components/DocumentManager.tsx</files>
  <action>
    Add filter chips above the document list that allow filtering by status.

    1. Add state for active filters:
       ```typescript
       const [activeFilters, setActiveFilters] = useState<Set<string>>(new Set());
       ```

    2. Create FilterChips component (inline in DocumentManager.tsx):
       - Displays chips for: All, Pending, Processing, Embedded, Error
       - Each chip shows count: "Error (3)", "Pending (2)"
       - "All" chip is special: when selected, clears all filters
       - Toggle behavior: clicking a chip adds/removes it from activeFilters
       - Multiple chips can be active (combine with OR logic)
       - Styling: outline by default, filled when active
         - Active: bg-{color}-100 border-{color}-300 text-{color}-700
         - Inactive: border-gray-300 text-gray-600 hover:border-gray-400

    3. Compute filtered documents:
       ```typescript
       const filteredDocuments = useMemo(() => {
         if (activeFilters.size === 0) return documents;
         return documents.filter(doc => activeFilters.has(doc.status));
       }, [documents, activeFilters]);
       ```

    4. Compute status counts:
       ```typescript
       const statusCounts = useMemo(() => {
         const counts = { pending: 0, processing: 0, embedded: 0, error: 0 };
         documents.forEach(doc => {
           if (doc.status in counts) counts[doc.status as keyof typeof counts]++;
         });
         return counts;
       }, [documents]);
       ```

    5. Place FilterChips component between the header section and the document list

    6. Update the document list to map over `filteredDocuments` instead of `documents`

    7. Handle empty state: if filteredDocuments is empty but documents exist, show "No documents match the selected filters" with a clear button
  </action>
  <verify>
    Run dev server and verify:
    - Chips appear above document list
    - Counts are accurate
    - Clicking a chip filters the list
    - Multiple chips can be selected
    - Clicking "All" clears filters
    - Empty filter state shows appropriate message
  </verify>
  <done>Filter chips display counts and filter documents correctly; can combine multiple filters</done>
</task>

</tasks>

<verification>
1. Run `npm run dev:api` and navigate to /documents
2. Verify status badges show icon + text with muted colors
3. Verify processing status has visible pulse animation
4. Verify filter chips appear with correct counts
5. Verify clicking chips filters the document list
6. Verify multiple filters can be combined (OR logic)
7. Verify "All" chip clears all filters
</verification>

<success_criteria>
- StatusBadge component renders 4 states with icons and muted colors
- Processing status has pulsing animation visible
- Filter chips show accurate counts for each status
- Clicking chips filters document list correctly
- Multiple filters combinable with OR logic
- Empty filter state handled gracefully
</success_criteria>

<output>
After completion, create `.planning/phases/03-status-error-tracking/03-01-SUMMARY.md`
</output>
